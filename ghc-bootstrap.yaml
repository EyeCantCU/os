package:
  name: ghc-bootstrap
  version: 9.6.6
  epoch: 0
  description: "Bootstrap for the Glasgow Haskell Compiler."
  copyright:
    - license: BSD-3-Clause
  options:
    no-depends: true
    no-provides: true

environment:
  contents:
    packages:
      - busybox
      - dpkg # Extracts deb to installdir
      - gmp # Needed to build cache
      - libffi # Needed to build cache
      - numactl # Needed to build cache

pipeline:
  - if: ${{build.goarch}} == "amd64"
    uses: fetch
    with:
      uri: http://ftp.debian.org/debian/pool/main/g/ghc/ghc_${{package.version}}-4_${{build.goarch}}.deb
      expected-sha256: 6f47c85fdb72a1b8e7b654592e5014dbfb2b32915893704fa3bf1a1c7cac56c4
      extract: false

  - if: ${{build.goarch}} == "arm64"
    uses: fetch
    with:
      uri: http://ftp.debian.org/debian/pool/main/g/ghc/ghc_${{package.version}}-4_${{build.goarch}}.deb
      expected-sha256: 6f47c85fdb72a1b8e7b654592e5014dbfb2b32915893704fa3bf1a1c7cac56c4
      extract: false

  - runs: |
      # Extract GHC
      mkdir -p ${{targets.contextdir}}
      dpkg -x ghc_${{package.version}}-4_${{build.goarch}}.deb ${{targets.contextdir}}

update:
  enabled: false
  exclude-reason: This is bootstrap and should not be updated
